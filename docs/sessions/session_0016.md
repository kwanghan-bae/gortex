# Session 0016

## Goal
- 동적 메모리 최적화 및 토큰 절약 (Dynamic Memory Pruning v1)

## What Was Done
- **utils/memory.py 수정**: 메시지가 임계값(50개)을 초과할 경우, 첫 번째 요약 메시지와 최근 10개 메시지만 남기고 중간 데이터를 삭제하는 `prune_synapse` 메서드 구현.
- **main.py 수정**: 파일 캐시의 접근 이력을 추적하는 `cache_last_used` 도입. 매 턴 종료 후 최근 10회 이상의 노드 실행 동안 사용되지 않은 오래된 파일 캐시를 제거하는 LRU 정리 로직 구현.
- **연속성 확보**: 이제 세션이 아무리 길어져도 토큰 소비량과 메모리 점유율을 일정 수준 이하로 유지할 수 있음.

## Decisions
- 메시지 Pruning 시 요약본이 담긴 첫 번째 메시지를 반드시 보존하여 시스템의 정체성과 작업 목표를 유지함.
- 캐시 정리 주기를 '10개 노드 실행'으로 설정하여, 잦은 리로드로 인한 지연 시간 발생을 방지함.

## Problems / Blockers
- 현재 LRU 정리가 단순히 노드 실행 횟수 기반임. 향후 파일 크기나 중요도(active_constraints 참조 여부)를 결합한 더 정교한 가치 기반 정리 알고리즘 필요.

## Notes for Next Session
- 시스템의 '적응형 인터페이스'를 위해, 사용자의 현재 작업 맥락(코딩, 조사, 분석 등)에 따라 대시보드의 위젯 배치와 테마를 자동으로 변경하는 'Context-Aware UI Layout' 기능이 필요함.
